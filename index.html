<!DOCTYPE html>
<html>
<head>
	<title>Mesajlasma</title>
	
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <style type="text/css">

*{
  box-sizing: border-box;
}

body{
  font-family: "Helvetica Neue",sans-serif;
}

.mesajlar {
  
  height: 100%;
  margin: 0;
  overflow-y: scroll;
  padding-left: 0px;
}

.mesajlar li {
  padding: 15px 15px;
  background-color: #eee;
  list-style: none;
  display: list-item;
  border-bottom: 1px solid cadetblue;
  border-radius: 25px solid white;

  color: cadetblue;

}
.mesajlar li:nth-child(odd) {
}

.MesajAlani{
  height: 560px;
  padding-bottom: 0px;

}

.mesajText{ 
  border: 10px solid cadetblue;
  bottom: 0px !important;
  height: 60px;
  left: 0;
  outline: none;
  padding: 0px;
  position: fixed;
  right: 0;
  width: 100%;

}

.baslik{
  padding: 15px;
  background-color: aliceblue;
}
.baslik h2{
  text-align: center;
}
.content{
  margin: 100px 25px 60px 25px;
  border: 1px solid #343a40;
  height: 600px;
}
.kullanicidiv{
  background-color: cadetblue;
  height: 40px;
}

.kullanici{
  padding: 5px;
}


  </style>


</head>
<body>


<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
 
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarCollapse">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Link</a>
      </li>
      <li class="nav-item">
        <a class="nav-link disabled" href="#">Disabled</a>
      </li>
    </ul>
   
  </div>
   <a class="navbar-brand justify-content-center" href="#">Ortak Oda</a>
</nav>



<div class="content">
<div class="kullanicidiv"> <h4 class="kullanici">Adınız</h4></div>
 <div class="MesajAlani overflow-auto">
 <ul class="mesajlar"></ul>
 </div>
<input class="mesajText" onkeypress="yazildi()" placeholder="Mesajınızı yazınız." autofocus> 
</div>








    <script src="/socket.io/socket.io.js"></script>

    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>

    <script type="text/javascript">

    var socket = io.connect();
    var isim = prompt("Lütfen isminizi giriniz");
    socket.emit("gonder", isim);


    $('.kullanici').text(isim);
    
    socket.on("al", function(veri)
    {
      if (veri != isim) {
        alert(veri + "sisteme giriş yaptı.");
      }
    })



  function yazildi(){
    var tus = window.event.keyCode;
    if (tus == 13) {
     // var metin = document.getElementById('mesaj').value;
     var metin =  $(".mesajText").val();
     if( metin ==  '' )
     {
      alert("sa");
      exit;
     }
    socket.emit("mesaj", {"mesaj":metin,"kullanici":isim});

    $(".mesajText").val("");
    // document.getElementById('mesaj').value = "";

  }
  }


  socket.on("mesajAl", function(veri)
  {

        var llii =$("<li class='mesaj'></li>");
       
        
        $('.mesajlar').append($(llii)).text(veri.kullanici + ": " + veri.mesaj));
        $('mesaj').append($('<span>').text(veri.kullanici))

        // $('.mesajlar').append($('<li>').append($'<span>').text(veri.kullanici));

  });


    </script>

</body>
</html>
